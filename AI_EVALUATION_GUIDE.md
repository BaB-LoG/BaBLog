# BaBLog 식단 평가 기준 (설계안)

이 문서는 BaBLog의 AI 식단 평가가 어떤 기준으로 점수를 산정하는지 설명합니다.
현재 DB 스키마 기준(영양 9종)으로 구성되었습니다.

## 데이터 기준
- 목표치: `member_nutrient` 또는 `member_nutrient_daily`
- 실제 섭취: `meal`/`meal_log` 집계값
- 영양 항목: `kcal`, `protein`, `fat`, `saturated_fat`, `trans_fat`, `carbohydrates`, `sugar`, `natrium`, `cholesterol`

## 일간 점수 체계 (총 100점)

### 1) 열량 균형 (25점)
- 목표 kcal 대비 비율로 점수 산정
  - 95~105%: 25점
  - 90~95% / 105~110%: 22점
  - 80~90% / 110~120%: 16점
  - 70~80% / 120~130%: 10점
  - 60~70% / 130~140%: 5점
  - 60% 미만 / 140% 초과: 0점

### 2) 3대 영양소 비율 (20점)
- 탄수화물 45~65%, 단백질 10~30%, 지방 20~35%
- 각 항목별 점수를 합산(총 20점)
  - 범위 내: 만점
  - ±5%p 이탈: -2점
  - ±10%p 이탈: -4점
  - ±15%p 이탈: -6점
  - 그 이상: 0점

### 3) 단백질 충분성 (10점)
- 단백질 목표치 대비 비율
  - 90~110%: 10점
  - 80~89% / 111~120%: 7점
  - 70~79% / 121~130%: 4점
  - 60~69% / 131~150%: 2점
  - 60% 미만 / 150% 초과: 0점

### 4) 당류 (8점)
- 상한 기준 초과 여부
  - 100% 이하: 8점
  - 100~120%: 6점
  - 120~150%: 3점
  - 150% 초과: 0점

### 5) 나트륨 (8점)
- 상한 기준 초과 여부
  - 100% 이하: 8점
  - 100~120%: 6점
  - 120~150%: 3점
  - 150% 초과: 0점

### 6) 포화지방 (6점)
- 상한 기준 초과 여부
  - 100% 이하: 6점
  - 100~120%: 4점
  - 120~150%: 2점
  - 150% 초과: 0점

### 7) 트랜스지방 (3점)
- 상한 기준 초과 여부
  - 100% 이하: 3점
  - 100~110%: 1점
  - 110% 초과: 0점

### 8) 콜레스테롤 (3점)
- 상한 기준 초과 여부
  - 100% 이하: 3점
  - 100~120%: 2점
  - 120~150%: 1점
  - 150% 초과: 0점

### 9) 식사 패턴 (10점)
- 식사 횟수 기준
  - 3끼 모두 섭취: 10점
  - 2끼: 6점
  - 1끼: 2점
  - 0끼: 0점
- 추가 감점(최대 -2점)
  - 간식 kcal 비중이 30% 초과: -1점
  - 저녁 kcal 비중이 50% 초과: -1점

### 10) 식품 다양성 (7점)
- 하루 고유 식품 수 기준
  - 10개 이상: 7점
  - 7~9개: 5점
  - 4~6개: 3점
  - 1~3개: 1점

## 주간 점수 체계 (총 100점)

### 1) 기본 점수
- 7일 일간 점수 평균(0~100)

### 2) 일관성 보정 (최대 ±5점)
- 일간 점수 표준편차 기준
  - 5 이하: +3점
  - 6~10: +1점
  - 11~15: 0점
  - 16~20: -2점
  - 20 초과: -5점

### 3) 연속 달성 보너스 (최대 +3점, 선택)
- 80점 이상 연속 달성 기준
  - 3일 연속: +1점
  - 5일 연속: +2점
  - 7일 연속: +3점

## 등급 기준 (예시)
- 90~100: 매우 우수
- 80~89: 우수
- 70~79: 보통
- 60~69: 개선 필요
- 0~59: 집중 개선 필요

## 리스크 플래그(추천)
- 고나트륨 위험: natrium 150% 이상이 3일 이상
- 고당류 위험: sugar 150% 이상이 3일 이상
- 불규칙 식사: 2끼 이하가 4일 이상
- 영양 불균형: 3대 영양소 범위 이탈이 5일 이상

## AI 출력 구성(권장)
- 총점 + 등급
- 핵심 강점 1~2개
- 개선 포인트 1~2개
- 추천 행동 1~2개
